<div
  class="sidebar"
  [class.closed]="isSidebarClosed"
  (mouseleave)="closeSidebar($event)"
  (mouseover)="openSidebar($event)"
>

  <div class="logo-user-container">
    <div class="logo-container">
      <img src="/assets/logo header.png" alt="Logo">
    </div>

    <div class="user-info" *ngIf="!isSidebarClosed">
      <h2 class="hello-text" *ngIf="userData?.firstName && userData?.lastName">Hola,</h2>
      <h2 class="welcome-message" *ngIf="!userData?.firstName || !userData?.lastName">
        Bienvenido a <span class="college-name">Alce College</span>
      </h2>
      <p class="user-name" *ngIf="userData?.firstName && userData?.lastName">
        {{ userData?.firstName | titlecase }} {{ userData?.lastName | titlecase }}
      </p>
    </div>
  </div>

  <div class="nav-section">

    <div *ngIf="homeNavItem" class="nav-item" [class.active]="currentRoute === '/home'">
      <a [routerLink]="homeNavItem.route">
        <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#e8eaed" viewBox="0 -960 960 960" class="nav-icon">
          <path d="M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z"/>
        </svg>
        <span class="link-text">{{ homeNavItem.text }}</span>
      </a>
    </div>

    <ng-container *ngFor="let group of navGrouped">
      <div class="nav-group">
        <div
          class="category-header"
          [class.closed]="isSidebarClosed"
          (click)="toggleCategory(group.title)"
          [class.collapsed]="!categoryStates[group.title]"
          [class.active]="isCategoryActive(group.items)"
        >
          <ng-container [ngSwitch]="group.icon">

            <ng-container *ngSwitchCase="'event'">
              <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#e8eaed" viewBox="0 -960 960 960">
                <path d="M280-640h400v-80H280v80Zm0 240h400v-80H280v80Zm0 240h250q-3-20-2.5-40t4.5-40H280v80Zm440 80-80-80h-80v-80h80l80-80v240ZM160-120q-33 0-56.5-23.5T80-200v-560q0-33 23.5-56.5T160-840h640q33 0 56.5 23.5T880-760v294q-17-6-34.5-10.5T810-486v-274H150v520h330q-2 10-2 20t2 20H160Zm320-360Z"/>
              </svg>
            </ng-container>

            <ng-container *ngSwitchCase="'school'">
              <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#e8eaed" viewBox="0 -960 960 960">
                <path d="M360-240ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q32 0 64.5 3.5T489-425q-13 17-22.5 35.5T451-351q-23-5-45.5-7t-45.5-2q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32h323q4 22 11 42t18 38H40Zm320-320q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47Zm400-160q0 66-47 113t-113 47q-11 0-28-2.5t-28-5.5q27-32 41.5-71t14.5-81q0-42-14.5-81T544-792q14-5 28-6.5t28-1.5q66 0 113 47t47 113Zm-400 80q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0-80Zm320 440q34 0 56.5-20t23.5-60q1-34-22.5-57T680-360q-34 0-57 23t-23 57q0 34 23 57t57 23Zm0 80q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 23-5.5 43.5T818-198L920-96l-56 56-102-102q-18 11-38.5 16.5T680-120Z"/>
              </svg>
            </ng-container>

            <ng-container *ngSwitchCase="'history'">
              <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#e8eaed" viewBox="0 -960 960 960">
                <path d="M480-120q-75 0-140.5-28.5T225-225q-49-49-77-114.5T120-480h80q0 117 81.5 198.5T480-200q117 0 198.5-81.5T760-480q0-117-81.5-198.5T480-760q-66 0-123.5 29T259-656h101v80H160v-200h80v64q42-42 99-66t121-24q75 0 140.5 28.5T735-735q49 49 77 114.5T840-480q0 75-28.5 140.5T735-225q-49 49-114.5 77T480-120Zm40-240-120-120v-240h80v200l100 100-60 60Z"/>
              </svg>
            </ng-container>

            <ng-container *ngSwitchCase="'link'">
              <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#e8eaed" viewBox="0 -960 960 960">
                <path d="M440-280H280q-83 0-141.5-58.5T80-480q0-83 58.5-141.5T280-680h160v80H280q-50 0-85 35t-35 85q0 50 35 85t85 35h160v80ZM320-440v-80h320v80H320Zm200 160v-80h160q50 0 85-35t35-85q0-50-35-85t-85-35H520v-80h160q83 0 141.5 58.5T880-480q0 83-58.5 141.5T680-280H520Z"/>
              </svg>
            </ng-container>

            <ng-container *ngSwitchCase="'test'">
              <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#e8eaed" viewBox="0 -960 960 960">
                <path d="M280-80v-120h-80v-80h80v-80h-80v-80h80v-80h-80v-80h80v-80h400v80h80v80h-80v80h80v80h-80v80h80v80h-80v120H280Zm80-80h240v-80H360v80Zm0-160h240v-80H360v80Zm0-160h240v-80H360v80Z"/>
              </svg>
            </ng-container>

            <ng-container *ngSwitchCase="'reportes'">
              <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#e8eaed" viewBox="0 -960 960 960">
                <path d="M640-640h120v-80H640v80Zm0 120h120v-80H640v80Zm0 120h120v-80H640v80Zm-560 80v-400q0-33 23.5-56.5T160-800h400q33 0 56.5 23.5T640-720v80h-80v-80H160v400h400v-80h80v80q0 33-23.5 56.5T560-200H160q-33 0-56.5-23.5T80-280Zm80 0h400v-400H160v400Zm0 0v-400 400Z"/>
              </svg>
            </ng-container>

            <ng-container *ngSwitchCase="'notifications'">
              <div class="notification-icon-wrapper" [ngClass]="{'has-unread': unreadCount && unreadCount > 0}">
                <svg xmlns="http://www.w3.org/2000/svg"
                    height="24px"
                    width="24px"
                    viewBox="0 -960 960 960"
                    fill="#e3e3e3">
                  <path d="M160-200v-80h80v-280q0-83 50-147.5T420-792v-28q0-25 
                          17.5-42.5T480-880q25 0 42.5 17.5T540-820v28q80 20 
                          130 84.5T720-560v280h80v80H160Zm320-300Zm0 
                          420q-33 0-56.5-23.5T400-160h160q0 33-23.5 
                          56.5T480-80ZM320-280h320v-280q0-66-47-113t-113-47q-66 
                          0-113 47t-47 113v280Z"/>
                </svg>

                <span *ngIf="unreadCount && unreadCount > 0" class="notification-badge">
                  {{ unreadCount }}
                </span>
              </div>
            </ng-container>

            <ng-container *ngSwitchCase="'email'">
              <div class="notification-icon-wrapper">
                <svg style="margin-top: 3px; width: 17px; height: 17px;" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm320-280L160-640v400h640v-400L480-440Zm0-80 320-200H160l320 200ZM160-640v-80 480-400Z"/></svg>
              </div>
            </ng-container>

            <ng-container *ngSwitchCase="'whatsapp'">
              <svg style="width: 17px; height: 17px;" xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#25D366" viewBox="0 0 32 32">
                <path d="M16 .5C7.44.5.5 7.44.5 16c0 2.82.73 5.58 2.12 8.02L.5 31.5l7.7-2.02C10.42 30.8 13.17 31.5 16 31.5c8.56 0 15.5-6.94 15.5-15.5S24.56.5 16 .5Zm0 28c-2.58 0-5.08-.68-7.28-1.96l-.52-.3-4.57 1.19 1.21-4.45-.34-.55A12.4 12.4 0 0 1 3.5 16c0-6.89 5.61-12.5 12.5-12.5S28.5 9.11 28.5 16 22.89 28.5 16 28.5Zm7.16-9.42c-.4-.2-2.36-1.17-2.73-1.3-.37-.14-.64-.2-.9.2-.27.4-1.04 1.3-1.28 1.56-.23.27-.47.3-.87.1-.4-.2-1.69-.62-3.23-1.97-1.19-1.06-2-2.36-2.23-2.76-.23-.4-.02-.61.18-.8.19-.18.4-.47.6-.7.2-.24.27-.4.4-.67.14-.27.07-.5-.03-.7-.1-.2-.9-2.14-1.23-2.94-.33-.8-.66-.7-.9-.7-.23 0-.5 0-.77.04-.27.03-.7.1-1.07.5-.37.4-1.4 1.36-1.4 3.32s1.43 3.84 1.63 4.11c.2.27 2.81 4.27 6.8 5.99.95.41 1.7.65 2.27.84.95.3 1.82.26 2.5.16.76-.11 2.36-.96 2.7-1.9.34-.93.34-1.73.24-1.9-.1-.18-.36-.28-.76-.48Z"/>
              </svg>
            </ng-container>

            <ng-container *ngSwitchCase="'config'">
              <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#e8eaed" viewBox="0 -960 960 960">
                <path d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"/>
              </svg>
            </ng-container>

          </ng-container>

          <span>{{ group.title }}</span>
          <i class="fas fa-chevron-down chevron-icon"></i>
        </div>

        <ul *ngIf="categoryStates[group.title]" class="group-list">
          <li *ngFor="let item of group.items">
            <a
              *ngIf="item.roles.includes(userData?.role || UserRole.STUDENT)"
              [routerLink]="item.route"
              (click)="closeSidebar($event)"
            >
              <span class="link-text">{{ item.text }}</span>
            </a>
          </li>
        </ul>

      </div>
    </ng-container>
  </div>

  <div class="logout">
    <a (click)="openLogoutModal()">
      <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#e8eaed" viewBox="0 -960 960 960">
        <path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h280v80H200Zm440-160-55-58 102-102H360v-80h327L585-622l55-58 200 200-200 200Z"/>
      </svg>
      <span class="link-text">Salir</span>
    </a>
  </div>

</div>

<div
  class="arrow-icon"
  *ngIf="isSidebarClosed"
  (click)="openSidebar($event)"
>
  <i class="fas fa-chevron-right"></i>
</div>

<app-modal
  [showModal]="modalConfig.show"
  [message]="modalConfig.message"
  [isError]="false"
  [isInfo]="true"
  [showButtons]="true"
  (confirmAction)="modalConfig.confirm && modalConfig.confirm()"
  (close)="modalConfig.close()"
/>
