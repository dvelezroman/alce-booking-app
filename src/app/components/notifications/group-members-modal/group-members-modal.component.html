<div class="modal" [ngClass]="{ 'is-active': show }">
  <div class="modal-background" (click)="onClose()"></div>

  <div class="modal-card">
    <header class="modal-card-head">
      <p class="modal-card-title">{{ group?.name }}</p>
      <button class="delete" aria-label="close" (click)="onClose()"></button>
    </header>

    <section class="modal-card-body">
      <!-- Usuarios actuales -->
      <div *ngIf="group?.users?.length; else fallbackIds">
        <p><strong>Integrantes:</strong></p>
        <ul class="user-list">
          <li *ngFor="let user of group?.users">
            <span>{{ user.firstName }} {{ user.lastName }}</span>
            <button
              class="delete-user-btn"
              title="Eliminar"
              (click)="removeUserFromGroup(user.id)"
            >
              ✖
            </button>
          </li>
        </ul>
      </div>

      <ng-template #fallbackIds>
        <p><strong>Usuarios:</strong></p>
        <ul class="user-list">
          <li *ngFor="let user of members">
            <span>{{ user.firstName }} {{ user.lastName }}</span>
            <button
              class="delete-user-btn"
              title="Eliminar"
              (click)="removeUserFromGroup(user.id)"
            >
              ✖
            </button>
          </li>
        </ul>
      </ng-template>

      <!-- NUEVOS BLOQUES -->

      <!-- Selector de tipo de usuario -->
      <div class="field mt-5">
        <label class="label">Seleccionar tipo de usuario</label>
        <div class="control">
          <div class="select is-fullwidth">
            <select (change)="onRoleChange($event)">
              <option [ngValue]="null">-- Selecciona --</option>
              <option value="student">Estudiantes</option>
              <option value="instructor">Instructores</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Selector de usuarios -->
      <div class="field mt-3" *ngIf="selectedRole">
        <app-user-selector
          [role]="selectedRole"
          (usersSelected)="onUsersSelected($event)"
        ></app-user-selector>
      </div>

      <!-- Botón para agregar -->
      <div class="field mt-4" *ngIf="selectedUsers.length">
        <div class="button-center-wrapper">
          <button class="button is-primary" (click)="addUsersToGroup()">
            Agregar al grupo
          </button>
        </div>
      </div>
    </section>
  </div>
</div>

<app-modal
  [showModal]="modal.show"
  [message]="modal.message"
  [title]="modal.title ?? ''"
  [isError]="modal.isError"
  [isSuccess]="modal.isSuccess"
  (close)="modal.close()"
></app-modal>