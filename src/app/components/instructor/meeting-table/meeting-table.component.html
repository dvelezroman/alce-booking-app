<div class="table-container">
  <table class="table-results is-fullwidth" *ngIf="meetings && meetings.length > 0">
    <thead>
      <tr>
        <th>Stage</th>
        <th>Categoría</th>
        <th>Nombre</th>
        <th>Fecha</th>
        <th>Hora</th>
        <th>Contenido</th>
        <th>Observación</th>
        <th>Abrió Enlace</th>
        <th>Marcar Asistencia</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let meeting of meetings">
        <td data-label="Stage">{{ meeting.stage?.number || 'Stage no disponible' }}</td>
        <td data-label="Categoría">{{ meeting.category || 'Categoría no disponible' }}</td>
        <td data-label="Nombre" style="white-space: normal; vertical-align: top;">
          <span class="clickable is-clickable" (click)="onHistoryClick(meeting)">
            {{ getStudentDisplayName(meeting) }}
            <span *ngIf="isNewUser(meeting)" class="badge-new" title="Estudiante nuevo">
              Nuevo
            </span>
          </span>
        </td>
        <td data-label="Fecha">{{ meeting.localdate | date: 'mediumDate':'UTC' }}</td>
        <td data-label="Hora">{{ meeting.localhour }}:00</td>
        <td data-label="Contenido">
          <button class="icon-button" (click)="showContent(meeting)">
            <span class="material-icons">menu_book</span>
          </button>
        </td>
        <td data-label="Observación" class="observation-cell">
          <span
            class="comment-icon material-icons"
            title="{{ getObservationTooltip(meeting) }}"
            (click)="showComment(meeting)"
          >
            comment
          </span>

          <span
            class="comment-text"
            *ngIf="!hasReinforcement(meeting)"
          >
           {{ (meeting.assessments && meeting.assessments[0].note) || meeting.student?.user?.comment || 'Sin observación' }}
          </span>

          <span
            *ngIf="hasReinforcement(meeting)"
            class="reinforcement-badge"
            title="Este estudiante tiene nota o recursos cargados"
          >
            Refuerzo
          </span>
        </td>
        <td data-label="Abrió Enlace">
          {{ didOpenLink(meeting) }}
        </td>
        <td data-label="Marcar Asistencia">
          <input 
            type="checkbox" 
            [checked]="meeting.present"
            (click)="onAssistanceClick($event, meeting)"
            [disabled]="!isToday(meeting.localdate)" 
          />
        </td>
      </tr>
    </tbody>
  </table>
</div>