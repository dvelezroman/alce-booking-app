<div class="section">
  <div class="form-container">

    <div class="input-dropdown-wrapper">
      <label>Estudiante</label>
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        (input)="onSearchChange(searchTerm)" 
        (blur)="hideDropdown()" 
        placeholder="Buscar estudiante"
      />

      <ul *ngIf="showUserDropdown">
        <li *ngFor="let user of filteredUsers" (click)="selectUser(user)">
          {{ user.firstName }} {{ user.lastName }}
        </li>
      </ul>
    </div>

    <div *ngIf="showStudentRequiredError" class="error">
      El estudiante es requerido.
    </div>

    <label>Desde</label>
    <input type="date" [(ngModel)]="fromDate" (ngModelChange)="onFromDateChange()" />
    <div *ngIf="showFromDateError" class="error">La fecha es requerida.</div>

    <label>Hasta</label>
    <input type="date" [(ngModel)]="toDate" (ngModelChange)="onToDateChange()" />
    <div *ngIf="showToDateError" class="error">La fecha es requerida.</div>

    <div class="field">
      <label>Stage</label>
      <div class="control">
        <div class="select is-fullwidth">
          <select [(ngModel)]="selectedStageId">
            <option value="">Selecciona el stage</option>
            <option *ngFor="let stage of stages" [value]="stage.id">
              {{ stage.description }}
            </option>
          </select>
        </div>
      </div>
    </div>

    <div class="button-block">
        <button class="button-primary" (click)="searchStudentDetail()">
            Buscar
        </button>
        
        <button class="button-secondary" [disabled]="!isReportGenerated" (click)="onDownloadClicked()">
            <span class="icon-svg-download">
            <svg xmlns="http://www.w3.org/2000/svg" height="17px" viewBox="0 -960 960 960" width="24px" fill="#6b6b6b">
                <path d="M480-320 280-520l56-58 104 104v-326h80v326l104-104 56 58-200 200ZM240-160q-33 0-56.5-23.5T160-240v-120h80v120h480v-120h80v120q0 33-23.5 56.5T720-160H240Z"/>
            </svg>
            </span>
            Descargar
        </button>
        </div>
    </div>

    <div class="report-actions">
        <button class="global-primary" (click)="summaryReport()">
            Reporte Completo
        </button>
        <button class="global-secondary" (click)="dailySummaryReport()">
            Reporte Diario
        </button>
    </div>
</div>