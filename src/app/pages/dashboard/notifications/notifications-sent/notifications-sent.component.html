<section class="sent-root">
  <div class="sent-page">
    <!-- Header -->
    <header class="sent-header">
      <div class="title-block">
        <h1 class="title">Enviados</h1>
        <p class="subtitle">Notificaciones enviadas</p>
      </div>
    </header>

    <!-- Toggle filtros -->
    <div class="filter-toggle-wrapper">
      <button class="filter-toggle-button" (click)="toggleFilters()">
        {{ showFilters ? 'Ocultar filtros' : 'Filtros' }}
      </button>
    </div>

    <!-- Filtros Desde / Hasta (usa .date-filters) -->
    <div *ngIf="showFilters" class="date-filters">
      <label for="fromDate">Desde</label>
      <input
        id="fromDate"
        type="date"
        [(ngModel)]="fromDate"
        (change)="onFilterChange()"
      />

      <label for="toDate">Hasta</label>
      <input
        id="toDate"
        type="date"
        [(ngModel)]="toDate"
        (change)="onFilterChange()"
      />
    </div>

    <!-- Separador -->
    <div class="divider"></div>

    <!-- Lista de notificaciones enviadas -->
    <section class="notifications-list">
      <!-- Sin resultados -->
      <div *ngIf="items.length === 0" class="placeholder">
        No has enviado ninguna notificación.
      </div>

      <!-- Tabla -->
      <div *ngIf="items.length > 0" class="table-wrapper">
        <div class="table-header">
          <div class="col-from">Para</div>
          <div class="col-title">Asunto</div>
          <div class="col-date">Fecha</div>
        </div>

        <div
          class="table-row"
          *ngFor="let n of items; trackBy: trackById"
          (click)="onRowClick(n)"
          role="button"
          tabindex="0"
        >
          <!-- Para -->
          <div class="col-from">
            <ng-container [ngSwitch]="n.scope">
              <span *ngSwitchCase="'INDIVIDUAL'">
                {{ n.to.length || 0 }} destinatario(s)
              </span>
              <span *ngSwitchCase="'STAGE_STUDENTS'">
                {{ n.stage?.number || 'Etapa' }} · {{ n.to.length || 0 }}
              </span>
              <span *ngSwitchDefault>
                {{ n.scope }}
              </span>
            </ng-container>
          </div>

          <!-- Asunto (título + snippet en una sola fila) -->
          <div class="col-title">
            <div class="subject-row">
              <span class="title" [title]="n.title">{{ n.title }}</span>
              <span class="sep">—</span>
              <span class="snippet-inline" *ngIf="n.message?.body as body">
                {{ body }}
              </span>
            </div>
          </div>

          <!-- Fecha -->
          <div class="col-date">
            {{ n.createdAt | date: 'short' }}
          </div>
        </div>
      </div>

      <!-- Paginación -->
      <div class="pagination" *ngIf="total > 0">
        <button
          class="pg-btn"
          (click)="onPrev()"
          [disabled]="page === 1"
          aria-label="Página anterior">
          ‹
        </button>

        <span class="pg-info">
          Página {{ page }}
          <span class="sep">·</span>
          Mostrando {{ startIndex }} – {{ endIndex }} de {{ total }}
        </span>

        <button
          class="pg-btn"
          (click)="onNext()"
          [disabled]="page * limit >= total"
          aria-label="Página siguiente">
          ›
        </button>
      </div>
    </section>
  </div>
</section>